{
  "TelemetryIngest": {
    "_comment": "Enable specific connectors by name (Simulator/RabbitMq/Kafka). Empty or omitted means all registered connectors run.",
    "Enabled": [
      "RabbitMq"
    ],
    "_commentBatchSize": "Number of telemetry messages per batch sent to router and sinks.",
    "BatchSize": 100,
    "_commentChannelCapacity": "Bounded channel capacity. Lower values apply backpressure sooner; higher values buffer more.",
    "ChannelCapacity": 10000,
    "EventSinks": {
      "_comment": "Enabled event sinks (Logging/ParquetStorage). Empty or omitted means all registered sinks run.",
      "Enabled": [
        "Logging"
      ]
    },
    "RabbitMq": {
      "_comment": "RabbitMQ connector settings (only used when RabbitMq is enabled).",
      "HostName": "mq",
      "Port": 5672,
      "UserName": "guest",
      "Password": "guest",
      "QueueName": "telemetry",
      "PrefetchCount": 100
    },
    "Kafka": {
      "_comment": "Kafka connector settings (only used when Kafka is enabled).",
      "BootstrapServers": "localhost:9092",
      "GroupId": "telemetry-ingest",
      "Topic": "telemetry",
      "EnableAutoCommit": false,
      "AutoOffsetReset": "Latest"
    },
    "Simulator": {
      "_comment": "Simulator connector settings (no env var fallback; set explicitly as needed).",
      "TenantId": "tenant",
      "_commentBuildingName": "Must match the Simulator seed building name for Point Snapshot lookup.",
      "BuildingName": "Simulator-Building",
      "_commentSpaceId": "Must match the Simulator seed area name for Point Snapshot lookup.",
      "SpaceId": "Simulator-Area",
      "_commentDeviceIdPrefix": "Device IDs are generated as {DeviceIdPrefix}{index+1}.",
      "DeviceIdPrefix": "sim-",
      "_commentDeviceCount": "Number of simulated devices (min 1).",
      "DeviceCount": 2,
      "_commentPointsPerDevice": "Points per device (min 1). Point IDs are p1..pN.",
      "PointsPerDevice": 3,
      "_commentIntervalMilliseconds": "Emission interval in ms (min 10).",
      "IntervalMilliseconds": 2000
    },
    "Mqtt": {
      "_comment": "MQTT connector settings (topic embeds tenant/device/point IDs).",
      "Host": "localhost",
      "Port": 1883,
      "ClientId": "silo-ingest-mqtt",
      "CleanSession": true,
      "KeepAliveSeconds": 30,
      "ReconnectDelayMs": 2000,
      "MaxReconnectDelayMs": 30000,
      "DropPolicy": "Block",
      "WriteTimeoutMs": 3000,
      "MaxInFlightMessages": 100,
      "TopicBindings": [
        {
          "Filter": "tenants/+/devices/+/points/+",
          "Qos": 1,
          "TopicRegex": "^tenants/(?<tenantId>[^/]+)/devices/(?<deviceId>[^/]+)/points/(?<pointId>[^/]+)$"
        }
      ],
      "Payload": {
        "ValueJsonPath": "$.value",
        "DateTimeJsonPath": "$.datetime",
        "DateTimeFormats": [
          "O"
        ]
      }
    }
  }
}
